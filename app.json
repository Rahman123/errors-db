{
  "name": "errors-db",
  "description": "API for capturing and providing solutions for errors generated by CumulusCi",
  "repository": "https://github.com/SFDO-Tooling/errors_db",
  "keywords": ["ci", "python", "django", "salesforce", "github"],
  "env": {
    "DJANGO_ALLOWED_HOSTS": {
      "description": "Heroku proxies web requests and Django needs to be configured to allow the forwards",
      "value": ".herokuapp.com"
    },
    "DJANGO_ADMIN_URL": {
      "description": "The url path to the admin section of the site",
      "value": "admin"
    },
    "DJANGO_SECRET_KEY": {
      "description": "A secret key used to provide cryptographic signing",
      "generator": "secret"
    },
    "DJANGO_HASHID_SALT": {
      "description": "Salt used to hash IDs that get exposed publicly",
      "generator": "secret"
    },
    "DJANGO_SETTINGS_MODULE": {
      "description": "The site settings to use",
      "value": "config.settings.production"
    },
    "DB_ENCRYPTION_KEY": {
      "description": "A key for encrypting using cryptography.fernet. Generate using cryptography.fernet.Fernet.generate_key"
    }
  },
  "formation": {
    "web": {
      "quantity": 1,
      "size": "free"
    },
    "dev_worker": {
      "quantity": 1,
      "size": "free"
    },
    "worker": {
      "quantity": 0,
      "size": "free"
    },
    "scheduler": {
      "quantity": 0,
      "size": "free"
    }
  },
  "image": "heroku/python",
  "addons": [
    "heroku-postgresql",
    "heroku-redis",
    "newrelic",
    "sentry"
  ],
  "buildpacks": [{ "url": "heroku/nodejs" }, { "url": "heroku/python" }],
  "environments": {
    "test": {
      "scripts": {
        "test-setup": "pip install --upgrade -r requirements/test.txt",
        "test": "pytest"
      },
      "env": {
        "DJANGO_SETTINGS_MODULE": "config.settings.test",
        "DATABASE_URL": "sqlite:///test.db"
      }
    }
  },
  "scripts": {
    "postdeploy": "python manage.py migrate --noinput"
  }
}
